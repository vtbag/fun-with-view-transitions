<html>

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Special+Elite&display=swap" rel="stylesheet" />
  <title>Episode 6</title>
  <link rel="shortcut icon" href="/tril.png" type="image/png" media="(prefers-color-scheme: light)">
  <link rel="shortcut icon" href="/trid.png" type="image/png" media="(prefers-color-scheme: dark)">
  <link rel="stylesheet" href="style.css" />
</head>

<body>

  <nav>
    <a href="/index.html">← All exercises</a><a href="https://vtbag.dev/fwvt/uncovering/">→ Episode 6 @vtbag.dev</a>
  </nav>
  <p>Source Code at <a href="https://github.com/vtbag/fun-with-view-transitions/blob/main/episode/6/page.html">GitHub</a></p>

  <div id="page1">
    <p>Clicking this button on desktop should start a cross-fade animation.</p>
    <button id="fails">Start</button>
    <p>Mysteriously, it does not work with Chromium browsers on mobile.</p>
    <p>(On desktop, open devtools and select mobile emulation)</p>
  </div>
  <p id="log"></p>


  <script>
    const originalInnerWidth = innerWidth;
    const originalInnerHeight = innerHeight;

  log.innerText = "Layout viewport: " + innerWidth + " x " + innerHeight;
    fails.addEventListener("click", () =>
      document.startViewTransition(() => {
        page1.outerHTML = `
<main><div id="page2">
  <p>
    What caught my eye was the small dot on the corner of the Discord icon.
    Someone had left a message. Quiet, patient, and waiting to be found.
  </p>
</div></main>`;
      }).finished.finally(() =>
        log.innerText = `Layout viewport: ${innerWidth} x ${innerHeight}. ${originalInnerWidth !== innerWidth || originalInnerHeight !== innerHeight ? "This DID CHANGE during the view transition, which is why the animation did not run." : "This DID NOT change during the view transition, so it's all good with your current browser or you SUCCESSFULLY fixed the root cause."}`
      )
    );
    document.startViewTransition || (document.body.innerHTML = `
    Your browser does not support View Transitions.<br>
    Please try a different browser.`);


  </script>
</body>

</html>